#!/usr/bin/env cbqn

âŸ¨_fixâŸ© â† â€¢Import "lib.bqn"

inp â† '0'-Ëœ>â€¢FLines "15.txt"

# part 1
râ€¿c â† â‰¢inp
incs â† âŸ¨0â€¿Â¯1, Â¯1â€¿0, 0â€¿1, 1â€¿0âŸ©
InGrid â† {(ğ•©â‰¥0)âˆ§â—‹(âˆ§Â´)ğ•©<râ€¿c}
wts â† â¥Šinp
edges â† âˆ¾(â†•Ã—Â´â‰¢inp)âˆ¾Â¨Â¨{{ğ•©+cÃ—ğ•¨}Â´Â¨InGridÂ¨âŠ¸/ğ•©âŠ¸+Â¨incs}Â¨â¥Šâ†•â‰¢inp

BellmanFord â† {
  ğ•Š edgesâ€¿wts:
  dist â† 0Â»âˆâ¥ŠËœrÃ—c
  { 
    ğ•Š ğ•©:
    {
	  uâ€¿v â† ğ•©âŠ‘edges
	  wt â† vâŠ‘wts
	  udâ€¿vd â† uâ€¿vâŠdist
	  (âˆâ‰ ud) âˆ§ (wt+ud)<vd ? (ğ•©+1)âŠ£dist (ud+wt)âŒ¾(vâŠ¸âŠ‘)â†©;
	  ğ•©+1
	}âŸ(â‰ edges) 0
	@
  }âŸ(Â¯1+rÃ—c) @
  dist
}

â€¢Show Â¯1âŠ‘BellmanFord edgesâ€¿wts

# Part 2(port of ngn's k soln):
ninp â† 9âŠ¸|âŒ¾(-âŸœ1)âˆ¾(<inp)++âŒœËœâ†•5

Ngn â† {ğ•Š x:râ€¿câ†â‰¢ğ•©,iâ†câ¥Šâˆ,Â¯1â€¿Â¯1âŠ‘{ğ•Š y:yâŒŠx+âŒŠÂ´âŸ¨iÂ»y, iÂ«y, âˆÂ«Ë˜y, âˆÂ»Ë˜yâŸ©}_fix 0âŒ¾âŠ‘ âˆâŒˆx}

â€¢Show Ngn ninp