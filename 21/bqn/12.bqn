#!/usr/bin/env cbqn

âŸ¨SplitâŸ© â† â€¢Import "lib.bqn"

inp â† '-'SplitÂ¨â€¢FLines "12.txt"

# Part 1:
nodes â† â·âˆ¾inp
conns â†{(nodesâŠâŠ‘Â¨ğ•©)âŠ”Â¯1âŠ‘Â¨ğ•©}inpâˆ¾âŒ½Â¨inp

â€¢Show âŸ¨âŸ©{
  ğ•¨ ğ•Š "end": 1;
  next â† (âŠ‘nodesâŠâ‹ˆğ•©)âŠ‘conns
  +Â´(ğ•¨âˆ¾('a'â‰¤âŠ‘ğ•©)â¥Šâ‹ˆğ•©)âŠ¸ğ•ŠÂ¨ next(Â¬âˆ˜âˆŠ/âŠ£)ğ•¨
}"start"

# Part 2:
â€¢Show âŸ¨"start"âŸ© {
  ğ•¨ ğ•Š "end": 1;
  w Find x:
  next â† (âŠ‘nodesâŠâ‹ˆğ•©)âŠ‘conns
  sum â† +Â´0=âˆŠw(Â¬âˆ˜âˆŠ/âŠ£)âŸ¨"start"âŸ© 
  { 
    (xâ‰¡"start")âˆ§wâ‰¢âŸ¨"start"âŸ© ? 0;
    sum > 1 ? 0;
    1=sum ? +Â´{(wâˆ¾('a'â‰¤âŠ‘x)â¥Šâ‹ˆx) Find ğ•©}Â¨next(Â¬âˆ˜âˆŠ/âŠ£)w;
    0=sum ? +Â´{(wâˆ¾('a'â‰¤âŠ‘x)â¥Šâ‹ˆx) Find ğ•©}Â¨next
  }
}"start"