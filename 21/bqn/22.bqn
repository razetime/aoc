#!/usr/bin/env cbqn
‚ü®Split‚ü© ‚Üê ‚Ä¢Import "lib.bqn"

inp ‚Üê {‚ü®'n'=1‚äëùï©, {‚Ä¢BQN¬®0‚Äø¬Ø1‚äè'.'Split 2‚Üìùï©}¬®',' Split 1‚äë' 'Splitùï©‚ü©}¬®‚Ä¢FLines "22.txt"

# Part 1:
init ‚Üê 101‚Äø101‚Äø101‚•ä0
Inside ‚Üê {‚ü®x1‚Äøx2, y1‚Äøy2, z1‚Äøz2‚ü© ùïä ‚ü®x3‚Äøx4, y3‚Äøy4, z3‚Äøz4‚ü©:(x1‚â•x3)‚àß(x2‚â§x4)‚àß(y1‚â•y3)‚àß(y2‚â§y4)‚àß(z1‚â•z3)‚àß(z2‚â§z4)}
#‚Ä¢Show +¬¥‚•äinit{b‚Äøx ùïä w: b¬®‚åæ(((‚•ä‚àæ‚åú)¬¥Range¬¥¬®x)‚ä∏‚äë) w}¬¥‚åΩ(Inside‚üú(3/‚ü®¬Ø50‚Äø50‚ü©)¬Ø1‚ä∏‚äë)¬®‚ä∏/inp

# Part 2:
# https://stackoverflow.com/a/12771129/4568534 is the main idea.

cubes ‚Üê ‚ü®‚ü©
{
  b‚Äøux‚Äøvx‚Äøuy‚Äøvy‚Äøuz‚Äøvz:
  cubes ‚Ü© (√ó‚â†¬®)‚ä∏/‚àæ{
    ux2‚Äøvx2‚Äøuy2‚Äøvy2‚Äøuz2‚Äøvz2:
    (ux > vx2 )‚à®( vx < ux2 )‚à®( uy > vy2 )‚à®( vy < uy2 )‚à®( uz > vz2 )‚à®( vz < uz2)?‚ãàùï©;
    ux2‚Äøvx2‚Äøuy2‚Äøvy2‚Äøuz2‚Äøvz2:
    splits ‚Üê ‚ü®‚ü©
		AS ‚Üê {splits ‚àæ‚Ü© ‚ãàùï©}
    {ux > ux2 ? AS ‚ü®ux2, ux-1, uy2, vy2, uz2, vz2‚ü©;@}
    {vx < vx2 ? AS ‚ü®vx+1, vx2, uy2, vy2, uz2, vz2‚ü©;@}
    {uy > uy2 ? AS ‚ü®ux2‚åàux, vx2‚åävx, uy2, uy-1, uz2, vz2‚ü©;@}
    {vy < vy2 ? AS ‚ü®ux2‚åàux, vx2‚åävx, vy+1, vy2, uz2, vz2‚ü©;@}
    {uz > uz2 ? AS ‚ü®ux2‚åàux, vx2‚åävx, uy2‚åàuy, vy2‚åävy, uz2, uz-1‚ü©;@}
    {vz < vz2 ? AS ‚ü®ux2‚åàux, vx2‚åävx, uy2‚åàuy, vy2‚åävy, vz+1, vz2‚ü©;@}
    splits
  }¬®cubes
  {b ? cubes ‚àæ‚Ü© ‚ãàux‚Äøvx‚Äøuy‚Äøvy‚Äøuz‚Äøvz;0}

  @
}¬®‚àæ‚àò‚àæ¬® inp

‚Ä¢Show +¬¥{ux‚Äøvx‚Äøuy‚Äøvy‚Äøuz‚Äøvz:(1+vx-ux)√ó(1+vy-uy)√ó1+vz-uz }¬®cubes

 
