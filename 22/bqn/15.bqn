lâ†â€¢Import "../../lib.bqn"
âŸ¨compile,matchall,replaceallâŸ©â†â€¢Import "../../bqn-pcre2/pcre2.bqn"
âŸ¨ToNumsâŸ©â†â€¢Import "../../bqn-libs/strings.bqn"
iâ†>(<Ë˜2â€¿2â¥ŠÂ·(âŠ‘Â·ToNumsâŠ‘)Â¨"-?\d+"_matchall)Â¨â€¢FLines "../inp/15"
[s,b]â†â‰i
dâ†(+Â´Â·|-Â´)Ë˜i

yâ†2_000_000
P1â†{
  ð•Š y:
  âˆ§âŸ¨âŸ©{
    0â‰¤tâ†(ð•¨âŠ‘d)-|(1âŠ‘ptâ†ð•¨âŠ‘s)-y ? ð•©âˆ¾âŸ¨âŸ¨-t,tâŸ©âŸ©+âŠ‘pt;ð•© 
  }Â´â†•â‰ s
}
â€¢Show âŠ‘Â¯1+0â€¿Â¯âˆž{sumâ€¿max ð•Š fâ€¿l:âŸ¨sum+(max<l)Ã—1+l-fâŒˆmax,maxâŒˆl+1âŸ©}ËœÂ´âŒ½P1 y

0{
  y ð•Š Â·:
  Â¯âˆž{
    ð•¨ ð•Š fâ€¿l:2=f-ð•¨? â€¢Show y+4_000_000Ã—f-1, â€¢Exit@;
    ð•¨âŒˆ1âŠ‘ð•©
  }ËœÂ´âŒ½P1 y
}Â´â†•4_000_001
