lâ†â€¢Import "../../lib.bqn"
iâ†(<"") l.Split â€¢FLines "../inp/11"
Parseâ†{
  Â·â€¿sâ€¿oâ€¿tsâ€¿trâ€¿fa:
  itâ‡(l.Dec 1âŠ¸â†“)Â¨','l.Split 17â†“s
  Sitâ‡{ğ•Š:itâ†©ğ•©}
  fiâ€¿seâ€¿thâ†{'o'=âŠ‘ğ•©?âŠ¢;"+":+;"*":Ã—;l.Dec ğ•©}Â¨' ' l.Split 19â†“o
  Opâ‡Fi Se Th
  tstâ‡l.Dec 21â†“ts
  tâ‡l.Dec 29â†“tr
  fâ‡l.Dec 30â†“fa
  scâ‡0
  Iscâ‡{ğ•Š:sc+â†©ğ•©}
}Â¨
i1â†Parse i
i2â†Parse i

_partâ†{
  times Trunc _r inp:
  {
    ğ•Š:
    {
      newâ†Trunc ğ•©.Op ğ•©.it
      mâ†0=ğ•©.tst|new
      tlâ†m/new
      flâ†mÂ¬âŠ¸/new
      tâ†ğ•©.tâŠ‘inp
      fâ†ğ•©.fâŠ‘inp
      t.Sit t.itâˆ¾tl
      f.Sit f.itâˆ¾fl
      ğ•©.Sit âŸ¨âŸ©
      ğ•©.Isc â‰ new
    }Â¨inp
  }âŸtimes @
  Ã—Â´2â†‘âˆ¨{ğ•©.sc}Â¨inp
}

â€¢Show 20 (âŒŠÃ·âŸœ3) _part i1
â€¢Show 10000 (Ã—Â´{ğ•©.tst}Â¨i2)âŠ¸| _part i2

